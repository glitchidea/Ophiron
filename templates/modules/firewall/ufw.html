{% load static %}
{% load i18n %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE|default:'en' }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% trans "UFW Firewall Management" %} - Ophiron</title>

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Bootstrap CSS for modals -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Base styles to match dashboard -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="{% static 'css/components/header.css' %}">
    <link rel="stylesheet" href="{% static 'css/dashboard/style.css' %}">
    <!-- Page specific styles -->
    <link rel="stylesheet" href="{% static 'css/firewall/ufw.css' %}">

    <!-- Bootstrap JS for modals -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Header and Navigation Scripts -->
    <script defer src="{% static 'js/components/header.js' %}"></script>
    <!-- JavaScript Translations -->
    <script>
        window.jsTranslations = {
            'checking': '{% trans "Checking..." %}',
            'enabled': '{% trans "Enabled" %}',
            'disabled': '{% trans "Disabled" %}',
            'enable': '{% trans "Enable" %}',
            'disable': '{% trans "Disable" %}',
            'refresh': '{% trans "Refresh" %}',
            'back': '{% trans "Back" %}',
            'loading_rules': '{% trans "Loading rules..." %}',
            'no_rules_found': '{% trans "No Rules Found" %}',
            'no_firewall_rules_configured': '{% trans "No firewall rules are currently configured." %}',
            'action': '{% trans "Action" %}',
            'direction': '{% trans "Direction" %}',
            'source': '{% trans "Source" %}',
            'destination': '{% trans "Destination" %}',
            'port': '{% trans "Port" %}',
            'protocol': '{% trans "Protocol" %}',
            'firewall_rules': '{% trans "Firewall Rules" %}',
            'ufw_firewall': '{% trans "UFW Firewall" %}',
            'error_loading_status': '{% trans "Error loading UFW status" %}',
            'error_loading_rules': '{% trans "Error loading UFW rules" %}',
            'error_toggling_ufw': '{% trans "Error toggling UFW" %}',
            'ufw_enabled_successfully': '{% trans "UFW enabled successfully" %}',
            'ufw_disabled_successfully': '{% trans "UFW disabled successfully" %}',
            'ufw_enable_failed': '{% trans "UFW enable failed" %}',
            'ufw_disable_failed': '{% trans "UFW disable failed" %}'
        };
    </script>
    
    <!-- Page script -->
    <script defer src="{% static 'js/firewall/ufw.js' %}"></script>
</head>
<body>
    {% csrf_token %}
    <div class="dashboard-container">
        {% include 'components/header.html' %}

        <main class="dashboard-main">
            <!-- UFW Management -->
            <div class="ufw-management">
                <!-- Page Header -->
                <div class="ufw-header">
                    <div class="ufw-header-content">
                        <div class="ufw-title">
                            <h1>
                                <i class="fas fa-fire"></i>
                                {% trans "UFW Firewall" %}
                            </h1>
                            <div class="ufw-status" id="ufwStatusIndicator">
                                <div class="status-dot"></div>
                                <span class="status-text">{% trans "Checking..." %}</span>
                            </div>
                        </div>
                        <div class="ufw-actions">
                            <button id="toggleUfw" class="btn-toggle">
                                <i class="fas fa-power-off"></i>
                                <span id="toggleText">{% trans "Enable" %}</span>
                            </button>
                            <button id="refreshUfw" class="btn-secondary">
                                <i class="fas fa-sync-alt"></i>
                                {% trans "Refresh" %}
                            </button>
                            <a href="{% url 'firewall:selection' %}" class="btn-secondary">
                                <i class="fas fa-arrow-left"></i>
                                {% trans "Back" %}
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Rules Section -->
                <div class="ufw-rules-section">
                    <div class="ufw-rules-header">
                        <h3>
                            <i class="fas fa-list"></i>
                            {% trans "Firewall Rules" %}
                            <span class="rules-count" id="rulesCount">(0)</span>
                        </h3>
                    </div>
                    
                    <!-- Loading State -->
                    <div class="rules-loading" id="ufwRulesLoading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>{% trans "Loading rules..." %}</span>
                    </div>

                    <!-- Rules Table -->
                    <table class="rules-table" id="ufwRulesTable" style="display: none;">
                        <thead>
                            <tr>
                                <th class="col-number">#</th>
                                <th class="col-action">{% trans "Action" %}</th>
                                <th class="col-direction">{% trans "Direction" %}</th>
                                <th class="col-source">{% trans "Source" %}</th>
                                <th class="col-destination">{% trans "Destination" %}</th>
                                <th class="col-port">{% trans "Port" %}</th>
                                <th class="col-protocol">{% trans "Protocol" %}</th>
                            </tr>
                        </thead>
                        <tbody id="ufwRulesTableBody">
                            <!-- Rules will be loaded here -->
                        </tbody>
                    </table>

                    <!-- Empty State -->
                    <div class="rules-empty" id="ufwRulesEmpty" style="display: none;">
                        <i class="fas fa-shield-alt"></i>
                        <h3>{% trans "No Rules Found" %}</h3>
                        <p>{% trans "No firewall rules are currently configured." %}</p>
                    </div>
                </div>
            </div>
        </main>
    </div>
</body>
</html>
