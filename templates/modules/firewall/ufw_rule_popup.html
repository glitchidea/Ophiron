<!-- UFW Rule Form Modal -->
<div id="ufwRuleModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>
                <i class="fas fa-plus-circle"></i>
                Create New UFW Rule
            </h3>
            <button class="modal-close" id="closeModal">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="modal-body">
            <form id="ufwRuleForm" class="ufw-rule-form">
                <!-- Rule Type Selection -->
                <div class="form-section">
                    <h4>Rule Configuration</h4>
                    
                        <div class="form-row">
                            <div class="form-group">
                                <label for="ruleAction">Action</label>
                                <select id="ruleAction" name="action">
                                    <option value="allow">Allow</option>
                                    <option value="deny">Deny</option>
                                    <option value="reject">Reject</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="ruleDirection">Direction</label>
                                <select id="ruleDirection" name="direction">
                                    <option value="in">Incoming</option>
                                    <option value="out">Outgoing</option>
                                    <option value="any">Any</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="ruleProtocol">Protocol</label>
                                <select id="ruleProtocol" name="protocol">
                                    <option value="tcp">TCP</option>
                                    <option value="udp">UDP</option>
                                    <option value="icmp">ICMP</option>
                                    <option value="any">Any</option>
                                </select>
                            </div>
                        </div>
                </div>

                <!-- Network Configuration -->
                <div class="form-section">
                    <h4>Network Configuration</h4>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="sourceIp">Source IP/Network</label>
                            <input type="text" id="sourceIp" name="source_ip" 
                                   placeholder="192.168.1.1 or 192.168.1.0/24 or any" 
                                   title="Enter source IP, subnet, or 'any'">
                            <small class="form-help">Examples: 192.168.1.1, 192.168.1.0/24, any</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="destIp">Destination IP/Network</label>
                            <input type="text" id="destIp" name="dest_ip" 
                                   placeholder="192.168.1.1 or 192.168.1.0/24 or any"
                                   title="Enter destination IP, subnet, or 'any'">
                            <small class="form-help">Examples: 192.168.1.1, 192.168.1.0/24, any</small>
                        </div>
                    </div>
                </div>

                <!-- Port Configuration -->
                <div class="form-section">
                    <h4>Port Configuration</h4>
                    
                    <div class="form-group">
                        <label for="rulePorts">Ports</label>
                        <input type="text" id="rulePorts" name="ports" 
                               placeholder="8080 or 8080,8090 or 8080:8090"
                               title="Enter ports: single (8080), multiple (8080,8090), range (8080:8090), or mixed">
                        <small class="form-help">
                            Examples: 8080 (single), 8080,8090 (multiple), 8080:8090 (range), 8080,8090:8100,9000 (mixed)
                        </small>
                    </div>
                </div>

                <!-- Rule Details -->
                <div class="form-section">
                    <h4>Rule Details</h4>
                    
                    <div class="form-group">
                        <label for="ruleComment">Comment</label>
                        <input type="text" id="ruleComment" name="comment" 
                               placeholder="Optional rule description"
                               title="Optional description for this rule">
                        <small class="form-help">Optional description to identify this rule</small>
                    </div>
                </div>

                <!-- Rule Preview -->
                <div class="form-section">
                    <h4>Rule Preview</h4>
                    <div class="rule-preview" id="rulePreview">
                        <div class="preview-content">
                            <i class="fas fa-info-circle"></i>
                            <span>Configure the rule above to see the preview</span>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        
        <div class="modal-footer">
            <button type="button" class="btn-secondary" id="cancelRule">
                <i class="fas fa-times"></i>
                Cancel
            </button>
            <button type="submit" class="btn-primary" id="createRule" form="ufwRuleForm">
                <i class="fas fa-plus"></i>
                Create Rule
            </button>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteRuleModal" class="modal">
    <div class="modal-content small">
        <div class="modal-header">
            <h3>
                <i class="fas fa-exclamation-triangle"></i>
                Delete Rule
            </h3>
            <button class="modal-close" id="closeDeleteModal">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="modal-body">
            <p>Are you sure you want to delete this rule?</p>
            <div class="rule-to-delete" id="ruleToDelete">
                <!-- Rule details will be populated here -->
            </div>
        </div>
        
        <div class="modal-footer">
            <button type="button" class="btn-secondary" id="cancelDelete">
                <i class="fas fa-times"></i>
                Cancel
            </button>
            <button type="button" class="btn-danger" id="confirmDelete">
                <i class="fas fa-trash"></i>
                Delete Rule
            </button>
        </div>
    </div>
</div>
